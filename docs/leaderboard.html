<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>QueryGym: Query Reformulation Methods Leaderboard</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --primary-dark: #1e40af;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --bg-body: #f0f4f8;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --code-bg: #f8fafc;
            --table-row-hover: #f8fafc;
            --header-gradient: linear-gradient(to right, #667eea 0%, #764ba2 100%);
        }

        [data-theme="dark"] {
            --primary-color: #60a5fa;
            --primary-dark: #3b82f6;
            --bg-light: #1e293b;
            --bg-white: #0f172a;
            --bg-body: #020617;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #334155;
            --border-light: #1e293b;
            --code-bg: #1e293b;
            --table-row-hover: #1e293b;
            --header-gradient: linear-gradient(to right, #4338ca 0%, #6b21a8 100%);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-body);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .header-section {
            background: var(--header-gradient);
            padding: 3rem 0;
            color: white;
            box-shadow: var(--shadow-lg);
            position: relative;
        }

        .header-controls {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .header-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            color: white;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .header-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            color: white;
            text-decoration: none;
        }

        .theme-toggle {
            padding: 0.5rem;
            width: 40px;
            height: 40px;
            justify-content: center;
        }

        .theme-toggle i {
            font-size: 1.1rem;
        }

        .header-section h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header-section .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .header-section .fa-trophy {
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5), 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .main-container {
            max-width: 1440px;
            margin: -2rem auto 3rem;
            padding: 0 2rem;
            position: relative;
            z-index: 10;
        }

        .intro-card {
            background: var(--bg-white);
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .intro-card p {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
        }

        .leaderboard-card {
            background: var(--bg-white);
            border-radius: 8px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .table-header {
            background: var(--bg-light);
            padding: 1.5rem;
            border-bottom: 2px solid var(--border-color);
        }

        .table-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
        }

        .leaderboard-table thead {
            background: var(--bg-light);
        }

        .leaderboard-table thead th {
            padding: 1rem;
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            border-bottom: 2px solid var(--border-color);
            text-align: center;
            vertical-align: middle;
        }

        .leaderboard-table thead th.config-col {
            text-align: left;
            width: 1%;
            background: var(--border-light);
        }

        .leaderboard-table thead th.method-col {
            text-align: left;
            min-width: 160px;
            width: 160px;
            background: var(--border-light);
        }

        .leaderboard-table thead th.metric-col {
            min-width: 70px;
            width: 70px;
            background: var(--bg-light);
            color: var(--text-secondary);
            padding: 1rem 0.5rem;
        }

        .leaderboard-table thead th.sortable {
            cursor: pointer;
            user-select: none;
            position: relative;
            transition: background-color 0.2s ease;
        }

        .leaderboard-table thead th.sortable:hover {
            background: var(--border-color);
        }

        .leaderboard-table thead th.sortable .sort-indicator {
            display: inline-block;
            margin-left: 0.5rem;
            opacity: 0.5;
            font-size: 0.7rem;
        }

        .leaderboard-table thead th.sortable.sort-asc .sort-indicator,
        .leaderboard-table thead th.sortable.sort-desc .sort-indicator {
            opacity: 1;
        }

        .leaderboard-table thead th.sortable.sort-asc .sort-indicator::after {
            content: ' ▲';
        }

        .leaderboard-table thead th.sortable.sort-desc .sort-indicator::after {
            content: ' ▼';
        }

        .leaderboard-table thead th.sortable {
            position: relative;
        }

        .leaderboard-table thead th.sortable::after {
            content: '⇅';
            display: inline-block;
            margin-left: 0.25rem;
            opacity: 0.4;
            font-size: 0.7rem;
            font-weight: normal;
            transition: opacity 0.2s ease, transform 0.2s ease;
            vertical-align: middle;
        }

        .leaderboard-table thead th.sortable:hover::after {
            opacity: 0.8;
            transform: scale(1.1);
        }

        .leaderboard-table thead th.sortable.sort-asc::after,
        .leaderboard-table thead th.sortable.sort-desc::after {
            opacity: 0;
        }

        .leaderboard-table thead th.separator-col + th {
            border-left: 1px solid rgba(203, 213, 225, 0.4);
        }

        .leaderboard-table thead th.dataset-header.metric-col {
            background: linear-gradient(to right, #dde4fc 0%, #d4dcfa 50%, #ccd5f8 100%) !important;
            color: #3b4a9a !important;
            font-weight: 700;
            font-size: 0.85rem;
            padding: 1rem 0.75rem;
            border-top: 1px solid rgba(255, 255, 255, 0.6);
            border-bottom: 1px solid rgba(255, 255, 255, 0.6);
        }

        .leaderboard-table thead tr:first-child th.dataset-header.metric-col:nth-child(5),
        .leaderboard-table thead tr:first-child th.dataset-header.metric-col:nth-child(7) {
            border-left: 1px solid rgba(203, 213, 225, 0.4);
        }

        .leaderboard-table thead th.dataset-header {
            background: linear-gradient(to right, #dde4fc 0%, #d4dcfa 50%, #ccd5f8 100%) !important;
            color: #3b4a9a !important;
            font-weight: 700;
            font-size: 0.8rem;
            padding: 1rem 0.75rem;
            border-top: 1px solid rgba(255, 255, 255, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
        }

        .leaderboard-table tbody tr {
            transition: background-color 0.15s ease;
            border-bottom: 1px solid var(--border-light);
        }

        .leaderboard-table tbody tr:hover {
            background-color: var(--table-row-hover);
        }

        .leaderboard-table tbody tr.expanded-row {
            background-color: var(--table-row-hover);
        }

        .leaderboard-table tbody td {
            padding: 1rem;
            vertical-align: middle;
            text-align: center;
            font-size: 0.875rem;
        }

        .leaderboard-table tbody tr:not(.expandable-content) td.separator-col + td {
            border-left: 1px solid rgba(203, 213, 225, 0.4);
        }

        .leaderboard-table tbody td.config-cell {
            text-align: left;
            font-weight: 500;
            color: var(--text-primary);
            border-right: 1px solid var(--border-light);
        }

        .leaderboard-table tbody td.method-name {
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.85rem;
        }

        .config-badges {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
            width: fit-content;
        }

        .config-badge {
            display: inline-flex;
            align-items: center;
            flex-direction: column;
            padding: 0.5rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            width: fit-content;
            min-width: 170px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .config-badge small {
            display: block;
            margin-top: 0.2rem;
            line-height: 1.2;
        }

        .badge-llm {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            color: #1e40af;
            border: 1px solid #93c5fd;
        }

        .badge-llm i {
            margin-right: 0.4rem;
            font-size: 0.85rem;
            color: #1e40af;
        }
        
        .config-badge span[style*="display: flex"] i {
            margin-right: 0.4rem;
        }

        .badge-retrieval {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            color: #9f1239;
            border: 1px solid #f9a8d4;
        }

        .badge-retrieval i {
            margin-right: 0.4rem;
            font-size: 0.85rem;
            color: #9f1239;
        }

        .metric-value {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.8rem;
            font-weight: 400;
            color: var(--text-secondary);
            padding: 0.2rem 0.3rem;
            border-radius: 4px;
            display: inline-block;
            min-width: 60px;
        }

        .expand-icon {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--border-light);
            color: var(--text-secondary);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.75rem;
            border: 1px solid var(--border-color);
        }

        .expand-icon:hover {
            background: var(--border-color);
            color: var(--text-primary);
        }

        .expand-icon.expanded {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .expandable-content {
            background: var(--bg-light);
            border-top: 2px solid var(--border-color);
            padding: 0;
            overflow-x: auto;
            max-width: 100%;
            box-sizing: border-box;
        }

        .content-tabs {
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-white);
            padding: 0 1.5rem;
            display: flex;
            gap: 0;
        }

        .content-tab {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .content-tab:hover {
            color: var(--text-primary);
            background: var(--bg-light);
        }

        .content-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: var(--bg-light);
        }

        .tab-content {
            padding: 2rem;
            background: var(--bg-white);
            overflow-x: auto;
            max-width: 100%;
            box-sizing: border-box;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        blockquote.mycode {
            border-left: 3px solid var(--border-color);
            margin-left: 0;
            margin-top: 1rem;
            margin-bottom: 1rem;
            padding-left: 1.25rem;
            background: var(--code-bg);
            padding: 1rem 1.25rem;
            border-radius: 4px;
            text-align: left;
            overflow-x: auto;
            max-width: 100%;
            box-sizing: border-box;
        }

        blockquote.mycode pre {
            margin: 0;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-width: 100%;
        }

        blockquote.mycode code {
            color: var(--text-primary);
            background: transparent;
            padding: 0;
        }

        .command-label {
            color: var(--text-primary);
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .copy-code-button {
            border-radius: 4px;
            min-width: 50px;
            background: var(--text-secondary);
            color: white;
            cursor: pointer;
            border: none;
            font-family: 'Inter', sans-serif;
            font-size: 0.75rem;
            font-weight: 500;
            text-align: center;
            padding: 0.4rem 0.75rem;
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            transition: all 0.2s ease;
        }

        .copy-code-button:hover {
            background: var(--primary-color);
        }

        blockquote.mycode {
            position: relative;
        }

        .notes-section {
            background: var(--bg-white);
            border-radius: 8px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .notes-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1.25rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .notes-section ul {
            list-style: none;
            padding: 0;
        }

        .notes-section li {
            padding: 0.75rem 0;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-light);
            font-size: 0.9rem;
        }

        .notes-section li:last-child {
            border-bottom: none;
        }

        .notes-section li strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .highlight-box {
            display: inline-block;
            background: #dcfce7;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-weight: 500;
            color: #166534;
            font-size: 0.875rem;
        }

        .programmatic-section {
            background: var(--bg-white);
            border-radius: 8px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .programmatic-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1.25rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .separator-col {
            display: none;
        }

        @media (max-width: 1400px) {
            .leaderboard-table {
                font-size: 0.8rem;
            }
            
            .leaderboard-table tbody td {
                padding: 0.75rem 0.5rem;
            }
        }
    </style>
</head>
<body>

    <!-- Header Section -->
    <div class="header-section">
        <div class="header-controls">
            <a href="./" class="header-btn">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <button class="header-btn theme-toggle" id="themeToggle" title="Toggle dark mode">
                <i class="fas fa-moon"></i>
            </button>
        </div>
        <div class="container text-center">
            <h1><i class="fas fa-trophy me-2"></i>QueryGym Leaderboard</h1>
            <p class="subtitle">Query Reformulation Methods Performance Evaluation</p>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Introduction Card -->
        <div class="intro-card">
            <p>
                The leaderboard below provides comprehensive performance metrics for QueryGym query reformulation methods 
                across different LLM configurations and retrieval backends. Each row represents a unique method configuration. 
                <strong>Click on any metric column header (⇅) to sort methods by that metric.</strong> Click on any row to expand 
                and view detailed commands for reproducing the results.
            </p>
        </div>

        <!-- Leaderboard Card -->
        <div class="leaderboard-card">
            <div class="table-header">
                <h2><i class="fas fa-chart-line me-2"></i>Performance Metrics</h2>
            </div>
            
            <div class="table-responsive">
                <table class="leaderboard-table">
                    <thead>
                        <tr>
                            <th class="config-col">Configuration</th>
                            <th class="method-col">Method</th>
                            <th class="dataset-header metric-col" colspan="3">TREC DL 2019</th>
                            <th class="separator-col"></th>
                            <th class="dataset-header metric-col" colspan="3">TREC DL 2020</th>
                            <th class="separator-col"></th>
                            <th class="dataset-header metric-col" colspan="3">DL HARD</th>
                        </tr>
                        <tr>
                            <th></th>
                            <th></th>
                            <th class="metric-col sortable" data-sort="dl19-ap" title="Click to sort by AP (TREC DL 2019)">AP<span class="sort-indicator"></span></th>
                            <th class="metric-col sortable" data-sort="dl19-ndcg" title="Click to sort by nDCG@10 (TREC DL 2019)">nDCG@10<span class="sort-indicator"></span></th>
                            <th class="metric-col sortable" data-sort="dl19-recall" title="Click to sort by R@1K (TREC DL 2019)">R@1K<span class="sort-indicator"></span></th>
                            <th class="separator-col"></th>
                            <th class="metric-col sortable" data-sort="dl20-ap" title="Click to sort by AP (TREC DL 2020)">AP<span class="sort-indicator"></span></th>
                            <th class="metric-col sortable" data-sort="dl20-ndcg" title="Click to sort by nDCG@10 (TREC DL 2020)">nDCG@10<span class="sort-indicator"></span></th>
                            <th class="metric-col sortable" data-sort="dl20-recall" title="Click to sort by R@1K (TREC DL 2020)">R@1K<span class="sort-indicator"></span></th>
                            <th class="separator-col"></th>
                            <th class="metric-col sortable" data-sort="dlhard-ap" title="Click to sort by AP (DL HARD)">AP<span class="sort-indicator"></span></th>
                            <th class="metric-col sortable" data-sort="dlhard-ndcg" title="Click to sort by nDCG@10 (DL HARD)">nDCG@10<span class="sort-indicator"></span></th>
                            <th class="metric-col sortable" data-sort="dlhard-recall" title="Click to sort by R@1K (DL HARD)">R@1K<span class="sort-indicator"></span></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- BM25 Baseline -->
                        <tr>
                            <td class="config-cell">
                                <div class="config-badges">
                                    <span class="config-badge badge-retrieval">
                                        <span style="display: flex; align-items: center; justify-content: center;">
                                            <i class="fas fa-search"></i>BM25
                                        </span>
                                        <small style="font-size: 0.65rem; opacity: 0.85;">k1=0.9, b=0.4</small>
                                    </span>
                                </div>
                            </td>
                            <td class="method-name">
                                BM25 (Baseline)
                            </td>
                            <td><span class="metric-value">0.3013</span></td>
                            <td><span class="metric-value">0.5058</span></td>
                            <td><span class="metric-value">0.7501</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.2856</span></td>
                            <td><span class="metric-value">0.4796</span></td>
                            <td><span class="metric-value">0.7863</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.1595</span></td>
                            <td><span class="metric-value">0.2850</span></td>
                            <td><span class="metric-value">0.6806</span></td>
                        </tr>
                        <!-- Configuration: GPT-4.1-mini + BM25 -->
                        <tr class="accordion-row" data-target="row1">
                            <td class="config-cell" rowspan="7">
                                <div class="config-badges">
                                    <span class="config-badge badge-llm">
                                        <span style="display: flex; align-items: center; justify-content: center;">
                                            <i class="fas fa-brain"></i>GPT-4.1-mini
                                        </span>
                                        <small style="font-size: 0.65rem; opacity: 0.85;">temp=1.0, max_tokens=128</small>
                                    </span>
                                    <span class="config-badge badge-retrieval">
                                        <span style="display: flex; align-items: center; justify-content: center;">
                                            <i class="fas fa-search"></i>BM25
                                        </span>
                                        <small style="font-size: 0.65rem; opacity: 0.85;">k1=0.9, b=0.4</small>
                                    </span>
                                </div>
                            </td>
                            <td class="method-name">
                                <div class="expand-icon" data-row="row1" style="display: inline-flex; margin-right: 0.5rem;">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                Query2Doc (ZS)
                            </td>
                            <td><span class="metric-value">0.4508</span></td>
                            <td><span class="metric-value">0.6709</span></td>
                            <td><span class="metric-value">0.8746</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.4325</span></td>
                            <td><span class="metric-value">0.6323</span></td>
                            <td><span class="metric-value">0.8864</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.2276</span></td>
                            <td><span class="metric-value">0.3303</span></td>
                            <td><span class="metric-value">0.7704</span></td>
                        </tr>
                        <tr class="accordion-row" data-target="row2">
                            <td class="method-name">
                                <div class="expand-icon" data-row="row2" style="display: inline-flex; margin-right: 0.5rem;">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                Query2Doc (FS)
                            </td>
                            <td><span class="metric-value">0.4418</span></td>
                            <td><span class="metric-value">0.6532</span></td>
                            <td><span class="metric-value">0.8521</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.4051</span></td>
                            <td><span class="metric-value">0.6111</span></td>
                            <td><span class="metric-value">0.8869</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.2260</span></td>
                            <td><span class="metric-value">0.3388</span></td>
                            <td><span class="metric-value">0.7842</span></td>
                        </tr>
                        <tr class="accordion-row" data-target="row3">
                            <td class="method-name">
                                <div class="expand-icon" data-row="row3" style="display: inline-flex; margin-right: 0.5rem;">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                Query2Doc (CoT)
                            </td>
                            <td><span class="metric-value">0.4145</span></td>
                            <td><span class="metric-value">0.6128</span></td>
                            <td><span class="metric-value">0.8495</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.3801</span></td>
                            <td><span class="metric-value">0.5894</span></td>
                            <td><span class="metric-value">0.8846</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.2225</span></td>
                            <td><span class="metric-value">0.3191</span></td>
                            <td><span class="metric-value">0.7524</span></td>
                        </tr>
                        <tr class="expandable-content" id="row1-content" style="display: none;">
                            <td colspan="13">
                                <div class="content-tabs">
                                    <button class="content-tab active" data-tab="row1-tab1">TREC DL 2019</button>
                                    <button class="content-tab" data-tab="row1-tab2">TREC DL 2020</button>
                                    <button class="content-tab" data-tab="row1-tab3">DL HARD</button>
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="row1-tab1">
                                        <div class="command-label">Command to reproduce results on TREC DL 2019:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row1-tab1-cmd">Copy</button>
                                            <pre id="row1-tab1-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2019 \
    --method query2doc \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --output-dir outputs/dl19_query2doc_zs</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row1-tab2">
                                        <div class="command-label">Command to reproduce results on TREC DL 2020:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row1-tab2-cmd">Copy</button>
                                            <pre id="row1-tab2-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2020 \
    --method query2doc \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --output-dir outputs/dl20_query2doc_zs</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row1-tab3">
                                        <div class="command-label">Command to reproduce results on DL HARD:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row1-tab3-cmd">Copy</button>
                                            <pre id="row1-tab3-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --queries-file path/to/queries.tsv \
    --qrels-file path/to/qrels.trec \
    --index-name msmarco-v1-passage \
    --method query2doc \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --output-dir outputs/dlhard_query2doc_zs</code></pre>
                                        </blockquote>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr class="expandable-content" id="row2-content" style="display: none;">
                            <td colspan="13">
                                <div class="content-tabs">
                                    <button class="content-tab active" data-tab="row2-tab1">TREC DL 2019</button>
                                    <button class="content-tab" data-tab="row2-tab2">TREC DL 2020</button>
                                    <button class="content-tab" data-tab="row2-tab3">DL HARD</button>
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="row2-tab1">
                                        <div class="command-label">Command to reproduce results on TREC DL 2019:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row2-tab1-cmd">Copy</button>
                                            <pre id="row2-tab1-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2019 \
    --method query2doc \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"mode":"fs","num_examples":4,"dataset_type":"msmarco",' \
    '"collection_path":"path/to/collection.tsv",' \
    '"train_queries_path":"path/to/queries.train.tsv","train_qrels_path":"path/to/qrels.train.tsv"}' \
    --output-dir outputs/dl19_query2doc</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row2-tab2">
                                        <div class="command-label">Command to reproduce results on TREC DL 2020:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row2-tab2-cmd">Copy</button>
                                            <pre id="row2-tab2-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2020 \
    --method query2doc \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"mode":"fs","num_examples":4,"dataset_type":"msmarco",' \
    '"collection_path":"path/to/collection.tsv",' \
    '"train_queries_path":"path/to/queries.train.tsv","train_qrels_path":"path/to/qrels.train.tsv"}' \
    --output-dir outputs/dl20_query2doc</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row2-tab3">
                                        <div class="command-label">Command to reproduce results on DL HARD:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row2-tab3-cmd">Copy</button>
                                            <pre id="row2-tab3-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --queries-file path/to/queries.tsv \
    --qrels-file path/to/qrels.trec \
    --index-name msmarco-v1-passage \
    --method query2doc \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"mode":"fs","num_examples":4,"dataset_type":"msmarco",' \
    '"collection_path":"path/to/collection.tsv",' \
    '"train_queries_path":"path/to/queries.train.tsv","train_qrels_path":"path/to/qrels.train.tsv"}' \
    --output-dir outputs/dlhard_query2doc</code></pre>
                                        </blockquote>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr class="expandable-content" id="row3-content" style="display: none;">
                            <td colspan="13">
                                <div class="content-tabs">
                                    <button class="content-tab active" data-tab="row3-tab1">TREC DL 2019</button>
                                    <button class="content-tab" data-tab="row3-tab2">TREC DL 2020</button>
                                    <button class="content-tab" data-tab="row3-tab3">DL HARD</button>
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="row3-tab1">
                                        <div class="command-label">Command to reproduce results on TREC DL 2019:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row3-tab1-cmd">Copy</button>
                                            <pre id="row3-tab1-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2019 \
    --method query2doc \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"mode":"cot"}' \
    --output-dir outputs/dl19_query2doc_cot</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row3-tab2">
                                        <div class="command-label">Command to reproduce results on TREC DL 2020:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row3-tab2-cmd">Copy</button>
                                            <pre id="row3-tab2-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2020 \
    --method query2doc \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"mode":"cot"}' \
    --output-dir outputs/dl20_query2doc_cot</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row3-tab3">
                                        <div class="command-label">Command to reproduce results on DL HARD:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row3-tab3-cmd">Copy</button>
                                            <pre id="row3-tab3-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --queries-file path/to/queries.tsv \
    --qrels-file path/to/qrels.trec \
    --index-name msmarco-v1-passage \
    --method query2doc \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"mode":"cot"}' \
    --output-dir outputs/dlhard_query2doc_cot</code></pre>
                                        </blockquote>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr class="accordion-row" data-target="row4">
                            <td class="method-name">
                                <div class="expand-icon" data-row="row4" style="display: inline-flex; margin-right: 0.5rem;">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                Query2E (ZS)
                            </td>
                            <td><span class="metric-value">0.3709</span></td>
                            <td><span class="metric-value">0.5679</span></td>
                            <td><span class="metric-value">0.8384</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.3436</span></td>
                            <td><span class="metric-value">0.5624</span></td>
                            <td><span class="metric-value">0.8373</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.1845</span></td>
                            <td><span class="metric-value">0.3179</span></td>
                            <td><span class="metric-value">0.7642</span></td>
                        </tr>
                        <tr class="expandable-content" id="row4-content" style="display: none;">
                            <td colspan="13">
                                <div class="content-tabs">
                                    <button class="content-tab active" data-tab="row4-tab1">TREC DL 2019</button>
                                    <button class="content-tab" data-tab="row4-tab2">TREC DL 2020</button>
                                    <button class="content-tab" data-tab="row4-tab3">DL HARD</button>
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="row4-tab1">
                                        <div class="command-label">Command to reproduce results on TREC DL 2019:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row4-tab1-cmd">Copy</button>
                                            <pre id="row4-tab1-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --queries-file path/to/original_queries.tsv \
    --qrels-file path/to/qrels.trec \
    --index-name msmarco-v1-passage \
    --method query2e \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"mode":"zs"}' \
    --output-dir outputs/dl19_query2e_zs</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row4-tab2">
                                        <div class="command-label">Command to reproduce results on TREC DL 2020:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row4-tab2-cmd">Copy</button>
                                            <pre id="row4-tab2-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --queries-file path/to/original_queries.tsv \
    --qrels-file path/to/qrels.trec \
    --index-name msmarco-v1-passage \
    --method query2e \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"mode":"zs"}' \
    --output-dir outputs/dl20_query2e_zs</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row4-tab3">
                                        <div class="command-label">Command to reproduce results on DL HARD:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row4-tab3-cmd">Copy</button>
                                            <pre id="row4-tab3-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --queries-file path/to/original_queries.tsv \
    --qrels-file path/to/qrels.trec \
    --index-name msmarco-v1-passage \
    --method query2e \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"mode":"zs"}' \
    --output-dir outputs/dlhard_query2e_zs</code></pre>
                                        </blockquote>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr class="accordion-row" data-target="row5">
                            <td class="method-name">
                                <div class="expand-icon" data-row="row5" style="display: inline-flex; margin-right: 0.5rem;">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                CSQE
                            </td>
                            <td><span class="metric-value">0.4007</span></td>
                            <td><span class="metric-value">0.5962</span></td>
                            <td><span class="metric-value">0.8506</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.3542</span></td>
                            <td><span class="metric-value">0.5298</span></td>
                            <td><span class="metric-value">0.8431</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.2170</span></td>
                            <td><span class="metric-value">0.3194</span></td>
                            <td><span class="metric-value">0.7276</span></td>
                        </tr>
                        <tr class="expandable-content" id="row5-content" style="display: none;">
                            <td colspan="13">
                                <div class="content-tabs">
                                    <button class="content-tab active" data-tab="row5-tab1">TREC DL 2019</button>
                                    <button class="content-tab" data-tab="row5-tab2">TREC DL 2020</button>
                                    <button class="content-tab" data-tab="row5-tab3">DL HARD</button>
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="row5-tab1">
                                        <div class="command-label">Command to reproduce results on TREC DL 2019:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row5-tab1-cmd">Copy</button>
                                            <pre id="row5-tab1-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2019 \
    --method csqe \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 1024 \
    --method-params '{"retrieval_k":10,"gen_num":2}' \
    --output-dir outputs/dl19_csqe</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row5-tab2">
                                        <div class="command-label">Command to reproduce results on TREC DL 2020:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row5-tab2-cmd">Copy</button>
                                            <pre id="row5-tab2-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2020 \
    --method csqe \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 1024 \
    --method-params '{"retrieval_k":10,"gen_num":2}' \
    --output-dir outputs/dl20_csqe</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row5-tab3">
                                        <div class="command-label">Command to reproduce results on DL HARD:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row5-tab3-cmd">Copy</button>
                                            <pre id="row5-tab3-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --queries-file path/to/original_queries.tsv \
    --qrels-file path/to/qrels.trec \
    --index-name msmarco-v1-passage \
    --method csqe \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 1024 \
    --method-params '{"retrieval_k":10,"gen_num":2}' \
    --output-dir outputs/dlhard_csqe</code></pre>
                                        </blockquote>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr class="accordion-row" data-target="row6">
                            <td class="method-name">
                                <div class="expand-icon" data-row="row6" style="display: inline-flex; margin-right: 0.5rem;">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                LameR
                            </td>
                            <td><span class="metric-value">0.4185</span></td>
                            <td><span class="metric-value">0.6587</span></td>
                            <td><span class="metric-value">0.8611</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.4432</span></td>
                            <td><span class="metric-value">0.6353</span></td>
                            <td><span class="metric-value">0.8839</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.2562</span></td>
                            <td><span class="metric-value">0.3623</span></td>
                            <td><span class="metric-value">0.7887</span></td>
                        </tr>
                        <tr class="expandable-content" id="row6-content" style="display: none;">
                            <td colspan="13">
                                <div class="content-tabs">
                                    <button class="content-tab active" data-tab="row6-tab1">TREC DL 2019</button>
                                    <button class="content-tab" data-tab="row6-tab2">TREC DL 2020</button>
                                    <button class="content-tab" data-tab="row6-tab3">DL HARD</button>
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="row6-tab1">
                                        <div class="command-label">Command to reproduce results on TREC DL 2019:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row6-tab1-cmd">Copy</button>
                                            <pre id="row6-tab1-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2019 \
    --method lamer \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"retrieval_k":10,"gen_passages":5}' \
    --output-dir outputs/dl19_lamer</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row6-tab2">
                                        <div class="command-label">Command to reproduce results on TREC DL 2020:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row6-tab2-cmd">Copy</button>
                                            <pre id="row6-tab2-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2020 \
    --method lamer \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"retrieval_k":10,"gen_passages":5}' \
    --output-dir outputs/dl20_lamer</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row6-tab3">
                                        <div class="command-label">Command to reproduce results on DL HARD:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row6-tab3-cmd">Copy</button>
                                            <pre id="row6-tab3-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --queries-file path/to/original_queries.tsv \
    --qrels-file path/to/qrels.trec \
    --index-name msmarco-v1-passage \
    --method lamer \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"retrieval_k":10,"gen_passages":5}' \
    --output-dir outputs/dlhard_lamer</code></pre>
                                        </blockquote>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr class="accordion-row" data-target="row7">
                            <td class="method-name">
                                <div class="expand-icon" data-row="row7" style="display: inline-flex; margin-right: 0.5rem;">
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                                MuGI
                            </td>
                            <td><span class="metric-value">0.4766</span></td>
                            <td><span class="metric-value">0.6903</span></td>
                            <td><span class="metric-value">0.8822</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.4353</span></td>
                            <td><span class="metric-value">0.6300</span></td>
                            <td><span class="metric-value">0.8985</span></td>
                            <td class="separator-col"></td>
                            <td><span class="metric-value">0.2393</span></td>
                            <td><span class="metric-value">0.3515</span></td>
                            <td><span class="metric-value">0.7974</span></td>
                        </tr>
                        <tr class="expandable-content" id="row7-content" style="display: none;">
                            <td colspan="13">
                                <div class="content-tabs">
                                    <button class="content-tab active" data-tab="row7-tab1">TREC DL 2019</button>
                                    <button class="content-tab" data-tab="row7-tab2">TREC DL 2020</button>
                                    <button class="content-tab" data-tab="row7-tab3">DL HARD</button>
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="row7-tab1">
                                        <div class="command-label">Command to reproduce results on TREC DL 2019:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row7-tab1-cmd">Copy</button>
                                            <pre id="row7-tab1-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2019 \
    --method mugi \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"num_docs":5,"parallel":true,"mode":"zs"}' \
    --output-dir outputs/dl19_mugi_zs</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row7-tab2">
                                        <div class="command-label">Command to reproduce results on TREC DL 2020:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row7-tab2-cmd">Copy</button>
                                            <pre id="row7-tab2-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --dataset msmarco-v1-passage.trecdl2020 \
    --method mugi \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"num_docs":5,"parallel":true,"mode":"zs"}' \
    --output-dir outputs/dl20_mugi_zs</code></pre>
                                        </blockquote>
                                    </div>
                                    <div class="tab-pane" id="row7-tab3">
                                        <div class="command-label">Command to reproduce results on DL HARD:</div>
                                        <blockquote class="mycode">
                                            <button class="copy-code-button" data-copy="row7-tab3-cmd">Copy</button>
                                            <pre id="row7-tab3-cmd"><code>python examples/querygym_pyserini/pipeline.py \
    --queries-file path/to/original_queries.tsv \
    --qrels-file path/to/qrels.trec \
    --index-name msmarco-v1-passage \
    --method mugi \
    --model gpt-4.1-mini \
    --temperature 1.0 \
    --max-tokens 128 \
    --method-params '{"num_docs":5,"parallel":true,"mode":"zs"}' \
    --output-dir outputs/dlhard_mugi_zs</code></pre>
                                        </blockquote>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Notes Section -->
        <div class="notes-section">
            <h3><i class="fas fa-info-circle me-2"></i>Notes</h3>
            <ul>
                <li><strong>AP</strong>: Average Precision (AP@100)</li>
                <li><strong>nDCG@10</strong>: Normalized Discounted Cumulative Gain at rank 10</li>
                <li><strong>R@1K</strong>: Recall at rank 1000</li>
                <li>All results are reproducible using the commands shown in the expanded rows</li>
                <li>Configuration column shows the LLM and retrieval backend used for all methods in that group</li>
            </ul>
        </div>

        <!-- Programmatic Execution Section -->
        <div class="programmatic-section">
            <h3><i class="fas fa-code me-2"></i>Programmatic Execution</h3>
            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                All experimental runs shown in the above table can be programmatically executed using the QueryGym pipeline scripts.
                The pipeline command runs the complete workflow: reformulation, retrieval, and evaluation.
            </p>
            
            <div class="command-label">Example pipeline command:</div>
            <blockquote class="mycode">
                <pre><code>python scripts/querygym_pyserini/pipeline.py \
  --dataset msmarco-v1-passage.dev \
  --method query2doc \
  --model gpt-4 \
  --base-url https://api.openai.com/v1 \
  --api-key YOUR_API_KEY \
  --output-dir runs/query2doc-gpt4-bm25</code></pre>
            </blockquote>

            <p style="color: var(--text-secondary); margin-top: 1.5rem;">
                For more information, see the <a href="https://github.com/ls3-lab/QueryGym/blob/main/examples/querygym_pyserini/README.md" style="color: var(--primary-color); text-decoration: none; font-weight: 600;">QueryGym Pyserini Pipeline documentation</a>.
            </p>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Expand/Collapse functionality
        document.querySelectorAll('.expand-icon').forEach(icon => {
            icon.addEventListener('click', function() {
                const rowId = this.getAttribute('data-row');
                const contentRow = document.getElementById(rowId + '-content');
                const parentRow = this.closest('tr');
                
                if (contentRow.style.display === 'none') {
                    contentRow.style.display = 'table-row';
                    parentRow.classList.add('expanded-row');
                    this.classList.add('expanded');
                    this.innerHTML = '<i class="fas fa-chevron-up"></i>';
                } else {
                    contentRow.style.display = 'none';
                    parentRow.classList.remove('expanded-row');
                    this.classList.remove('expanded');
                    this.innerHTML = '<i class="fas fa-chevron-down"></i>';
                }
            });
        });

        // Tab switching functionality
        document.querySelectorAll('.content-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                const tabContainer = this.closest('.expandable-content');
                
                // Update active tab
                tabContainer.querySelectorAll('.content-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Update active pane
                const tabContent = tabContainer.querySelector('.tab-content');
                tabContent.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
                tabContent.querySelector('#' + tabId).classList.add('active');
            });
        });

        // Copy button functionality
        document.querySelectorAll('.copy-code-button').forEach(button => {
            button.addEventListener('click', function() {
                const targetId = this.getAttribute('data-copy');
                const codeElement = document.getElementById(targetId);
                const text = codeElement.textContent;
                
                navigator.clipboard.writeText(text).then(() => {
                    const originalText = this.textContent;
                    this.textContent = 'Copied!';
                    this.style.background = '#10b981';
                    
                    setTimeout(() => {
                        this.textContent = originalText;
                        this.style.background = '';
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy:', err);
                    this.textContent = 'Error';
                    setTimeout(() => {
                        this.textContent = 'Copy';
                    }, 2000);
                });
            });
        });

        // Sorting functionality
        const sortMap = {
            'dl19-ap': 2,
            'dl19-ndcg': 3,
            'dl19-recall': 4,
            'dl20-ap': 6,
            'dl20-ndcg': 7,
            'dl20-recall': 8,
            'dlhard-ap': 10,
            'dlhard-ndcg': 11,
            'dlhard-recall': 12
        };

        let currentSort = { column: null, direction: 'desc' };

        document.querySelectorAll('.sortable').forEach(header => {
            header.addEventListener('click', function() {
                const sortKey = this.getAttribute('data-sort');
                const columnIndex = sortMap[sortKey];
                const tbody = document.querySelector('.leaderboard-table tbody');
                
                // Get all accordion rows (main data rows)
                const accordionRows = Array.from(tbody.querySelectorAll('tr.accordion-row'));
                
                // Find the row with config cell and extract it
                let configCell = null;
                let rowspan = null;
                accordionRows.forEach(row => {
                    const cell = row.querySelector('td.config-cell');
                    if (cell) {
                        configCell = cell.cloneNode(true);
                        rowspan = parseInt(cell.getAttribute('rowspan') || '1');
                        // Remove config cell from original row temporarily
                        cell.remove();
                    }
                });
                
                // Determine sort direction
                if (currentSort.column === sortKey) {
                    currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
                } else {
                    currentSort.column = sortKey;
                    currentSort.direction = 'desc';
                }

                // Remove sort indicators from all headers
                document.querySelectorAll('.sortable').forEach(h => {
                    h.classList.remove('sort-asc', 'sort-desc');
                });

                // Add sort indicator to current header
                this.classList.add('sort-' + currentSort.direction);

                // Create pairs of accordion row and its expandable content
                // After removing config cell, all rows have same structure, so use columnIndex - 1
                const rowPairs = accordionRows.map(row => {
                    const target = row.getAttribute('data-target');
                    const expandable = document.getElementById(target + '-content');
                    // After config cell removal, metrics are at columnIndex - 1
                    const valueCell = row.cells[columnIndex - 1];
                    return {
                        accordion: row,
                        expandable: expandable || null,
                        value: parseFloat(valueCell?.querySelector('.metric-value')?.textContent || 0)
                    };
                });

                // Sort pairs by metric value
                rowPairs.sort((a, b) => {
                    if (currentSort.direction === 'asc') {
                        return a.value - b.value;
                    } else {
                        return b.value - a.value;
                    }
                });

                // Remove all rows from tbody
                const allRows = Array.from(tbody.querySelectorAll('tr'));
                allRows.forEach(row => row.remove());

                // Re-insert sorted pairs with config cell in first row
                rowPairs.forEach((pair, index) => {
                    if (index === 0 && configCell && rowspan) {
                        // Insert config cell as first cell in first row
                        const newConfigCell = configCell.cloneNode(true);
                        newConfigCell.setAttribute('rowspan', rowspan);
                        pair.accordion.insertBefore(newConfigCell, pair.accordion.cells[0]);
                    }
                    
                    tbody.appendChild(pair.accordion);
                    if (pair.expandable) {
                        tbody.appendChild(pair.expandable);
                    }
                });
            });
        });

        // Dark mode toggle
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = themeToggle.querySelector('i');
        
        // Check for saved theme preference or default to light
        const savedTheme = localStorage.getItem('querygym-theme') || 'light';
        if (savedTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
            themeIcon.classList.remove('fa-moon');
            themeIcon.classList.add('fa-sun');
        }
        
        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('querygym-theme', newTheme);
            
            if (newTheme === 'dark') {
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            } else {
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
            }
        });
    </script>

</body>
</html>

